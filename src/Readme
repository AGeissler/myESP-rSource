General Guidelines for the Installation of the ESP-r System
-----------------------------------------------------------
Note: this document is in the process of being revised
and some information is out of date.

Development for the native windows version of ESP-r is
covered in a separate document (although you might find
some useful information in this document)

1.  Create a directory, typcially /usr/esru. If necessary this can
    be a link to a directory "esru" located anywhere on your
    system (you will need to ask the superuser to do this).
    On Linux boxes and/or MacOSX you might want to locate
    the ESP-r distribution in /opt/esru 

    It is suggested that you create a user called esru to own
    this directory; this will offer more protection by
    preventing other users from overwriting the ESP-r files.

2.  Become user "esru" and cd to the /usr/esru directory. Make
    a sub-directory src/esp-r and place the compressed tar files
    that you downloaded there. These contain the source code and
    example models and documentation. There is a utility 
    script "unpacktargz" on the FTP site - run this to unpack 
    the compressed tar files that you downloaded.

3.  Add the location where you installed esp-r to your path
    for example:
    /usr/esru/bin and /usr/esru/esp-r/bin
    On some operating systems it may be necessary to add
    /usr/esru/esp-r/lib to your LD_LIBRARY_PATH environment
    variable (this is not usually required under Linux
    implementations).

4.  In /usr/esru/src/esp-r there is a script file called
    Install which will guide you through the installation
    procedure and allow you to make selections corresponding
    to the different operating systems and window managers.
    Answer the questions to suit your system. 

5.  Type "./Install" (for a complete installation) or
    "./Install -h" to see the other options.  Answer the
    questions as posed. 

6.  Set up your environment along the lines of the sample
    .* files of directory /usr/esru/src/esp-r/env.  In particular,
    set the fonts (setenv EFONTS ...) in your .login file as
    shown in the sample login file and your PATH as shown in
    the .cshrc or .bash_profile file.   N.B. if the defined fonts 
    do not exist ESP-r will probably crash on start-up. In most Linux
    implementations, acceptable fonts are allocated automatically
    and you do not need to modify your configuration except
    to add /usr/esru/bin and /usr/esru/esp-r/bin to your path
    as specified in step 3 above.

7.  The file /usr/esru/esp-r/default defines the default settings
    for example problems, climate, control, etc. These can be
    changed if the default settings offered in the standard
    distribution are not appropriate for your site.

8.  To run ESP-r on some Sun workstations it may be necessary
    to firstly define the default colour map.  This can be
    done by issuing the command "xstdcmap -default" or placing
    it in your .xinitrc or .openwin-init file.  With Solaris 7
    you will also need to add "xstdcmap -delete all" to your
    .xinitrc file.  If you are running OpenWindows and colour
    problems persist, try commenting out the line

          cmap_alloc -allscreens

    in the file /usr/openwin/lib/openwin-sys.

9.  The install process is essentially the same for most distributions
    of Linux, but you are advised to use the GNU compilers version 3.4
    rather than 4.0 because there are a few blocks of legacy code that
    do not compile with the newer compiler.

10. It is possible to compile ESP-r under Windows using Cygwin or 
    to run using native windows graphics via the MSYS compiler
    environment. ESP-r also compiles under OS X on Mac's and uses
    the Apple supplied X11 windowing environment.  Instructions for 
    these operating systems are found on the web
    page download site <http://www.esru.strath.ac.uk>.

11. ESP-r is also available via a subversion source code control
    repository https://svn2.cvsdude.com/espr/esp-r/branches/development_branch
    for the latest code and the official release version is also
    available at https://svn2.cvsdude.com/espr/esp-r/trunk
    Note these repositories are non-trival in size and include
    extensive testing and validation folders. If you want to
    join in the developer community please contact Ian Beausoliel-Morrison
    at ibeausol@nrcan.gc.ca.

12. With Linux Redhat Fedora Core 4, using the latest version of gcc,
    Fortran is not currently supported. To solve this:
    (i) Download and install (rpm -iv "name".rpm) the following packages:
       - compat-gcc-32-3.2.3-47.fc4.src.rpm (could be already installed)
       - compat-libf2c-32-3.2.3-47.fc4.i386.rpm
       - compat-gcc-32-g77-3.2.3-47.fc4.i386.rpm
    (ii) Edit the file Install and replace gcc by gcc32 (at least in the
         Linux part, option 3).
    (iii) Install as usual.
    Note that installing the libf2c package is necessary even if you want 
    to use the pre-compiled binaries that can be downloaded from the 
    ESRU website.

13. Some of the exemplar problems do not load correctly for Linux or SGI
    because the supplied binary files are for Sun workstations. This problem
    is currently being addressed.

14. The manual is set in troff format and can be found in
    directory ~esru/esp-r/manual.  But note that an on-line help 
    and Web-based tutorial facility are available. These are improving
    at a glacial pace. The user guide and data model details can also
    be obtained from the ESRU Web site in pdf format. (The Web
    address is http://www.esru.strath.ac.uk). There is an ESP-r
    cookbook included in the manual folder which is a strategic
    guide to the use of ESP-r.

15. In directory validation/QA, there are models and scripts which
    can be run to check on your implementation. See the Readme
    file in that directory for details.

16. If - or should we say when ;-) - problems are encountered
    please email us at esru@strath.ac.uk.


Good Luck
